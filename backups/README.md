# üíæ –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∏ –æ—Ç—á–µ—Ç—ã

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã.

## üìÇ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

### –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–§–∞–π–ª—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∏–º–µ—é—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏:
```
crewlife_sqlite_backup_YYYYMMDD_HHMMSS.db
```

–ì–¥–µ:
- `YYYYMMDD` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `HHMMSS` - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è

### –û—Ç—á–µ—Ç—ã

–û—Ç—á–µ—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö:
- `.xlsx` - Excel —Ñ–∞–π–ª—ã
- `.csv` - CSV —Ñ–∞–π–ª—ã
- `.pdf` - PDF –æ—Ç—á–µ—Ç—ã

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

```bash
# –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤—Ä—É—á–Ω—É—é
python3 scripts/backup_manager.py --create

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
python3 scripts/backup_manager.py --create --description "Before migration"
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∫–æ–ø–∏–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–ø–∏–π
python3 scripts/backup_manager.py --list

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–ø–∏–∏
python3 scripts/backup_manager.py --restore backups/crewlife_sqlite_backup_20251005_120000.db
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ cron –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ –≤ 2:00 –Ω–æ—á–∏:

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
0 2 * * * /usr/bin/python3 /root/CrewServiceWebsite/CrewServiceWebsite-1/scripts/backup_manager.py --create
```

## üìä –†–æ—Ç–∞—Ü–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π

–°–∫—Ä–∏–ø—Ç `backup_manager.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–æ—Ç–∞—Ü–∏–µ–π:

- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ**: –•—Ä–∞–Ω—è—Ç—Å—è 7 –¥–Ω–µ–π
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ**: –•—Ä–∞–Ω—è—Ç—Å—è 4 –Ω–µ–¥–µ–ª–∏
- **–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ**: –•—Ä–∞–Ω—è—Ç—Å—è 12 –º–µ—Å—è—Ü–µ–≤

–°—Ç–∞—Ä—ã–µ –∫–æ–ø–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞.

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–•—Ä–∞–Ω–∏—Ç–µ –∫–æ–ø–∏–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ**
   ```bash
   # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
   rsync -avz backups/ user@remote-server:/path/to/backups/
   ```

2. **–®–∏—Ñ—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
   ```bash
   # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–ø–∏–∏
   tar czf - backups/*.db | gpg -c > backup_encrypted.tar.gz.gpg
   ```

3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∫–æ–ø–∏–π**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
   python3 scripts/backup_manager.py --verify backups/crewlife_sqlite_backup_20251005_120000.db
   ```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:

```
backups/
‚îú‚îÄ‚îÄ daily/          # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–æ–ø–∏–∏ (7 –¥–Ω–µ–π)
‚îú‚îÄ‚îÄ weekly/         # –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ (4 –Ω–µ–¥–µ–ª–∏)
‚îú‚îÄ‚îÄ monthly/        # –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –∫–æ–ø–∏–∏ (12 –º–µ—Å—è—Ü–µ–≤)
‚îî‚îÄ‚îÄ reports/        # –û—Ç—á–µ—Ç—ã
    ‚îú‚îÄ‚îÄ 2025/
    ‚îÇ   ‚îú‚îÄ‚îÄ 01/
    ‚îÇ   ‚îú‚îÄ‚îÄ 02/
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
```

## üõ†Ô∏è –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
du -sh backups/
```

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–ø–∏–π

```bash
# –£–¥–∞–ª–∏—Ç—å –∫–æ–ø–∏–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
find backups/ -name "*.db" -mtime +30 -delete

# –£–¥–∞–ª–∏—Ç—å –æ—Ç—á–µ—Ç—ã —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π
find backups/ -name "*.xlsx" -mtime +90 -delete
```

### –°–∂–∞—Ç–∏–µ –∫–æ–ø–∏–π

```bash
# –°–∂–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–ø–∏–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
gzip backups/*.db

# –ú–∞—Å—Å–æ–≤–æ–µ —Å–∂–∞—Ç–∏–µ –∫–æ–ø–∏–π —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
find backups/ -name "*.db" -mtime +7 -exec gzip {} \;
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤:
```
logs/backup.log
```

–§–æ—Ä–º–∞—Ç –ª–æ–≥–∞:
```
[2025-10-05 12:00:00] INFO: Backup created: crewlife_sqlite_backup_20251005_120000.db
[2025-10-05 12:00:05] INFO: Backup size: 15.3 MB
[2025-10-05 12:00:05] INFO: Old backups removed: 2 files
```

## üÜò –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å–ª—É—á–∞–µ —Å–±–æ—è

### –ü–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã**
   ```bash
   pm2 stop all
   ```

2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
   ```bash
   python3 scripts/backup_manager.py --restore backups/latest_backup.db
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å**
   ```bash
   python3 scripts/backup_manager.py --verify crewlife-website/backend/crewlife.db
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã**
   ```bash
   pm2 start all
   ```

### –ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

```bash
# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∏–∑ –±—ç–∫–∞–ø–∞
sqlite3 backups/crewlife_sqlite_backup_20251005_120000.db ".dump users" > users_backup.sql

# –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—É—â—É—é –ë–î
sqlite3 crewlife-website/backend/crewlife.db < users_backup.sql
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/backup.log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞: `df -h`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `ls -la backups/`

---

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π, –ø—Ä–æ–≤–æ–¥—è —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ!
